<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SG - Como Llego</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        height: 100vh;
        overflow: hidden;
      }
    </style>
  </head>
  <body class="flex flex-col items-center justify-center h-screen bg-gray-100">
    <div class="w-full max-w-xs mx-auto p-4">
      <div class="flex justify-center mb-6">
        <img
          src="https://i.imgur.com/PZrOpqH.png"
          alt="Pilar del Este Logo"
          class="h-256 w-auto"
        />
      </div>

      <input
        type="number"
        id="numberInput"
        class="w-full p-4 text-lg border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="N¬∫ de LOTE"
        min="1"
        max="700"
        required
      />

      <button
        onclick="handleSubmit()"
        class="mt-4 w-full py-3 bg-blue-500 text-white text-lg font-semibold rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        Ir
      </button>
    </div>

    <!-- Footer -->
    <footer class="mt-8 text-gray-500 text-sm">
      üè° Desarrollado por Cova - Miranda
    </footer>

    <script>
      const coordsUrl =
        "https://bucket.sg-comollego.ar/coords.json";
      const googleMapsUrlTemplate =
        "https://www.google.com/maps/dir/?api=1&destination=<destination>&travelmode=driving&dir_action=navigate";

      async function handleSubmit() {
        const numberInput = document.getElementById("numberInput");
        const number = numberInput.value;

        try {
          const response = await fetch(coordsUrl);
          const coords = await response.json();
          console.log(coords);
          coords.forEach((coord) => {
            if (coord.lote === number) {
              const destinationUrl = googleMapsUrlTemplate.replace(
                "<destination>",
                `${coord.coord.lat},${coord.coord.lng}`,
              );
              window.location.href = destinationUrl;
            }
          });
        } catch (error) {
          console.error("Error al cargar los datos:", error);
        }
      }

      window.addEventListener("DOMContentLoaded", () => {
        document.getElementById("numberInput").value = "";
      });
    </script>
  </body>
</html>
